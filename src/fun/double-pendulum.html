---
layout: false
permalink: /fun/double-pendulum/
---
<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="description" content="Double pendulum chaos simulation with colorful trails" />
        <title>Double Pendulum</title>

        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Atkinson+Hyperlegible:ital,wght@0,400;0,700;1,400;1,700&family=Atkinson+Hyperlegible+Mono:wght@400;500;600;700&display=swap" rel="stylesheet">
        <link rel="stylesheet" href="/assets/css/fun-pages.css">

        <style>
            :root {
                --accent: #ff6b9d;
                --accent-dim: rgba(255, 107, 157, 0.3);
                --accent-glow: rgba(255, 107, 157, 0.15);
            }
            .canvas-container {
                position: relative;
            }
            #trailCanvas, #pendulumCanvas {
                position: absolute;
                border: 1px solid var(--border);
                max-width: 100%;
            }
            #pendulumCanvas {
                border: none;
            }
            .slider-control input[type="range"] {
                width: 80px;
            }
            .slider-label {
                min-width: 70px;
            }
            .slider-value {
                min-width: 25px;
            }
            @media (max-width: 480px) {
                .slider-control input[type="range"] { width: 60px; }
            }
        </style>
    </head>
    <body>
        <a href="/fun/" class="back-link">← back</a>
        <button class="top-btn fullscreen-btn" id="fullscreenBtn" title="Fullscreen (F)">⛶</button>
        <button class="top-btn help-btn" id="helpBtn" title="Help (?)">?</button>

        <header class="game-header">
            <h1 class="game-title">Double Pendulum</h1>
            <div class="stats-bar">
                <div class="stat">
                    <span class="stat-label">Time:</span>
                    <span class="stat-value" id="timeDisplay">0.0s</span>
                </div>
                <div class="stat">
                    <span class="stat-label">Pendulums:</span>
                    <span class="stat-value" id="pendulumCount">5</span>
                </div>
                <div class="stat">
                    <span class="stat-label" id="statusLabel">Running</span>
                </div>
            </div>
        </header>

        <div class="canvas-container">
            <canvas id="trailCanvas"></canvas>
            <canvas id="pendulumCanvas"></canvas>
        </div>

        <div class="controls">
            <div class="control-row">
                <button class="primary" id="playPauseBtn">Pause</button>
                <button id="resetBtn">Reset</button>
                <button id="clearTrailsBtn">Clear Trails</button>
            </div>
            <div class="control-row">
                <div class="slider-control">
                    <span class="slider-label">Pendulums:</span>
                    <input type="range" id="countSlider" min="1" max="20" value="5">
                    <span class="slider-value" id="countDisplay">5</span>
                </div>
                <div class="slider-control">
                    <span class="slider-label">Angle Spread:</span>
                    <input type="range" id="spreadSlider" min="1" max="30" value="5">
                    <span class="slider-value" id="spreadDisplay">5°</span>
                </div>
                <div class="slider-control">
                    <span class="slider-label">Speed:</span>
                    <input type="range" id="speedSlider" min="1" max="5" value="1">
                    <span class="slider-value" id="speedDisplay">1x</span>
                </div>
            </div>
            <div class="control-row">
                <div class="slider-control">
                    <span class="slider-label">Length 1:</span>
                    <input type="range" id="len1Slider" min="50" max="150" value="100">
                    <span class="slider-value" id="len1Display">100</span>
                </div>
                <div class="slider-control">
                    <span class="slider-label">Length 2:</span>
                    <input type="range" id="len2Slider" min="50" max="150" value="100">
                    <span class="slider-value" id="len2Display">100</span>
                </div>
                <div class="slider-control">
                    <span class="slider-label">Trail Fade:</span>
                    <input type="range" id="fadeSlider" min="0" max="50" value="5">
                </div>
            </div>
        </div>

        <!-- Help Modal -->
        <div class="modal-overlay" id="helpModal">
            <div class="modal">
                <h2>Double Pendulum</h2>
                <p>A classic example of <a href="https://en.wikipedia.org/wiki/Chaos_theory" target="_blank" style="color: var(--accent)">chaotic motion</a>. Two pendulums connected end-to-end exhibit extreme sensitivity to initial conditions. <a href="https://en.wikipedia.org/wiki/Double_pendulum" target="_blank" style="color: var(--accent)">Learn more</a></p>
                <p>Watch how pendulums starting with nearly identical angles quickly diverge into completely different paths!</p>
                <p><strong>Controls:</strong></p>
                <ul>
                    <li><strong>Pendulums</strong> - Number of simultaneous pendulums (1-20)</li>
                    <li><strong>Angle Spread</strong> - Initial angle difference between pendulums</li>
                    <li><strong>Speed</strong> - Simulation speed multiplier (1-5x)</li>
                    <li><strong>Length 1/2</strong> - Arm lengths</li>
                    <li><strong>Trail Fade</strong> - How quickly trails disappear (0 = permanent)</li>
                </ul>
                <p><strong>Keyboard:</strong></p>
                <ul>
                    <li><strong>Space</strong> - Play/Pause</li>
                    <li><strong>R</strong> - Reset simulation</li>
                    <li><strong>C</strong> - Clear trails</li>
                    <li><strong>F</strong> - Fullscreen</li>
                </ul>
                <button class="modal-close" id="closeHelp">Got it</button>
            </div>
        </div>

        <script>
            // Physics constants
            const G = 9.81;
            const DT = 0.02;

            // State
            let pendulums = [];
            let running = true;
            let time = 0;
            let trailFade = 5;
            let pendulumCount = 5;
            let angleSpread = 5;
            let len1 = 100, len2 = 100;
            let speed = 1;
            const m1 = 10, m2 = 10;

            // Canvas
            const trailCanvas = document.getElementById('trailCanvas');
            const pendulumCanvas = document.getElementById('pendulumCanvas');
            const trailCtx = trailCanvas.getContext('2d');
            const pendulumCtx = pendulumCanvas.getContext('2d');

            let cx, cy; // Center point

            // Color palette
            function getColor(index, total) {
                const hue = (index / total) * 360;
                return `hsl(${hue}, 85%, 60%)`;
            }

            // Initialize
            function init() {
                const container = document.querySelector('.canvas-container');
                const maxWidth = container.clientWidth - 20;
                const maxHeight = container.clientHeight - 20;
                const size = Math.min(maxWidth, maxHeight, 700);

                trailCanvas.width = pendulumCanvas.width = size;
                trailCanvas.height = pendulumCanvas.height = size;

                cx = size / 2;
                cy = size / 3;

                resetPendulums();
            }

            // Reset pendulums with initial conditions
            function resetPendulums() {
                pendulums = [];
                time = 0;

                const baseAngle = Math.PI / 2; // Start horizontal

                for (let i = 0; i < pendulumCount; i++) {
                    const offset = (i - (pendulumCount - 1) / 2) * (angleSpread * Math.PI / 180) / Math.max(1, pendulumCount - 1);
                    pendulums.push({
                        a1: baseAngle + offset,
                        a2: baseAngle,
                        a1_v: 0,
                        a2_v: 0,
                        color: getColor(i, pendulumCount),
                        trail: []
                    });
                }

                clearTrails();
                updateStats();
            }

            // Clear trails
            function clearTrails() {
                trailCtx.fillStyle = '#0a0a0f';
                trailCtx.fillRect(0, 0, trailCanvas.width, trailCanvas.height);
                pendulums.forEach(p => p.trail = []);
            }

            // Double pendulum physics (using equations of motion)
            function updatePendulum(p) {
                const { a1, a2, a1_v, a2_v } = p;

                // Angular acceleration calculations
                const num1 = -G * (2 * m1 + m2) * Math.sin(a1);
                const num2 = -m2 * G * Math.sin(a1 - 2 * a2);
                const num3 = -2 * Math.sin(a1 - a2) * m2;
                const num4 = a2_v * a2_v * len2 + a1_v * a1_v * len1 * Math.cos(a1 - a2);
                const den1 = len1 * (2 * m1 + m2 - m2 * Math.cos(2 * a1 - 2 * a2));
                const a1_a = (num1 + num2 + num3 * num4) / den1;

                const num5 = 2 * Math.sin(a1 - a2);
                const num6 = a1_v * a1_v * len1 * (m1 + m2);
                const num7 = G * (m1 + m2) * Math.cos(a1);
                const num8 = a2_v * a2_v * len2 * m2 * Math.cos(a1 - a2);
                const den2 = len2 * (2 * m1 + m2 - m2 * Math.cos(2 * a1 - 2 * a2));
                const a2_a = (num5 * (num6 + num7 + num8)) / den2;

                // Update velocities and positions
                p.a1_v += a1_a * DT;
                p.a2_v += a2_a * DT;
                p.a1 += p.a1_v * DT;
                p.a2 += p.a2_v * DT;

                // Calculate end positions
                const x1 = cx + len1 * Math.sin(p.a1);
                const y1 = cy + len1 * Math.cos(p.a1);
                const x2 = x1 + len2 * Math.sin(p.a2);
                const y2 = y1 + len2 * Math.cos(p.a2);

                return { x1, y1, x2, y2 };
            }

            // Draw trails
            function drawTrails() {
                if (trailFade > 0) {
                    trailCtx.fillStyle = `rgba(10, 10, 15, ${trailFade / 100})`;
                    trailCtx.fillRect(0, 0, trailCanvas.width, trailCanvas.height);
                }

                pendulums.forEach(p => {
                    if (p.trail.length > 1) {
                        trailCtx.beginPath();
                        trailCtx.moveTo(p.trail[0].x, p.trail[0].y);
                        for (let i = 1; i < p.trail.length; i++) {
                            trailCtx.lineTo(p.trail[i].x, p.trail[i].y);
                        }
                        trailCtx.strokeStyle = p.color;
                        trailCtx.lineWidth = 1.5;
                        trailCtx.stroke();
                    }
                });
            }

            // Draw pendulums
            function drawPendulums() {
                pendulumCtx.clearRect(0, 0, pendulumCanvas.width, pendulumCanvas.height);

                pendulums.forEach(p => {
                    const pos = updatePendulum(p);

                    // Store trail point
                    p.trail.push({ x: pos.x2, y: pos.y2 });
                    if (p.trail.length > 500) p.trail.shift();

                    // Draw arms
                    pendulumCtx.beginPath();
                    pendulumCtx.moveTo(cx, cy);
                    pendulumCtx.lineTo(pos.x1, pos.y1);
                    pendulumCtx.lineTo(pos.x2, pos.y2);
                    pendulumCtx.strokeStyle = p.color;
                    pendulumCtx.lineWidth = 2;
                    pendulumCtx.stroke();

                    // Draw joints
                    pendulumCtx.beginPath();
                    pendulumCtx.arc(pos.x1, pos.y1, 5, 0, Math.PI * 2);
                    pendulumCtx.fillStyle = p.color;
                    pendulumCtx.fill();

                    pendulumCtx.beginPath();
                    pendulumCtx.arc(pos.x2, pos.y2, 7, 0, Math.PI * 2);
                    pendulumCtx.fill();
                });

                // Draw pivot
                pendulumCtx.beginPath();
                pendulumCtx.arc(cx, cy, 6, 0, Math.PI * 2);
                pendulumCtx.fillStyle = '#555';
                pendulumCtx.fill();
            }

            // Update stats
            function updateStats() {
                document.getElementById('timeDisplay').textContent = time.toFixed(1) + 's';
                document.getElementById('pendulumCount').textContent = pendulumCount;
                document.getElementById('statusLabel').textContent = running ? 'Running' : 'Paused';
            }

            // Animation loop
            function animate() {
                if (running) {
                    for (let i = 0; i < speed; i++) {
                        time += DT;
                        drawTrails();
                        drawPendulums();
                    }
                    updateStats();
                }
                requestAnimationFrame(animate);
            }

            // Controls
            const playPauseBtn = document.getElementById('playPauseBtn');
            playPauseBtn.addEventListener('click', () => {
                running = !running;
                playPauseBtn.textContent = running ? 'Pause' : 'Play';
                updateStats();
            });

            document.getElementById('resetBtn').addEventListener('click', () => {
                resetPendulums();
            });

            document.getElementById('clearTrailsBtn').addEventListener('click', clearTrails);

            // Sliders
            const countSlider = document.getElementById('countSlider');
            const countDisplay = document.getElementById('countDisplay');
            countSlider.addEventListener('input', (e) => {
                pendulumCount = parseInt(e.target.value);
                countDisplay.textContent = pendulumCount;
                resetPendulums();
            });

            const spreadSlider = document.getElementById('spreadSlider');
            const spreadDisplay = document.getElementById('spreadDisplay');
            spreadSlider.addEventListener('input', (e) => {
                angleSpread = parseInt(e.target.value);
                spreadDisplay.textContent = angleSpread + '°';
            });

            const len1Slider = document.getElementById('len1Slider');
            const len1Display = document.getElementById('len1Display');
            len1Slider.addEventListener('input', (e) => {
                len1 = parseInt(e.target.value);
                len1Display.textContent = len1;
            });

            const len2Slider = document.getElementById('len2Slider');
            const len2Display = document.getElementById('len2Display');
            len2Slider.addEventListener('input', (e) => {
                len2 = parseInt(e.target.value);
                len2Display.textContent = len2;
            });

            const fadeSlider = document.getElementById('fadeSlider');
            fadeSlider.addEventListener('input', (e) => {
                trailFade = parseInt(e.target.value);
            });

            const speedSlider = document.getElementById('speedSlider');
            const speedDisplay = document.getElementById('speedDisplay');
            speedSlider.addEventListener('input', (e) => {
                speed = parseInt(e.target.value);
                speedDisplay.textContent = speed + 'x';
            });

            // Help modal
            const helpModal = document.getElementById('helpModal');
            document.getElementById('helpBtn').addEventListener('click', () => {
                helpModal.classList.add('show');
            });
            document.getElementById('closeHelp').addEventListener('click', () => {
                helpModal.classList.remove('show');
            });
            helpModal.addEventListener('click', (e) => {
                if (e.target === helpModal) helpModal.classList.remove('show');
            });

            // Fullscreen
            let isFullscreen = false;
            const fullscreenBtn = document.getElementById('fullscreenBtn');

            function toggleFullscreen() {
                isFullscreen = !isFullscreen;
                document.body.classList.toggle('fullscreen', isFullscreen);
                fullscreenBtn.title = isFullscreen ? 'Exit Fullscreen (Esc)' : 'Fullscreen (F)';
                setTimeout(init, 50);
            }

            fullscreenBtn.addEventListener('click', toggleFullscreen);

            // Keyboard shortcuts
            document.addEventListener('keydown', (e) => {
                if (e.target.tagName === 'INPUT') return;

                switch(e.key.toLowerCase()) {
                    case 'f':
                        toggleFullscreen();
                        break;
                    case 'escape':
                        if (isFullscreen) toggleFullscreen();
                        if (helpModal.classList.contains('show')) helpModal.classList.remove('show');
                        break;
                    case ' ':
                        e.preventDefault();
                        running = !running;
                        playPauseBtn.textContent = running ? 'Pause' : 'Play';
                        updateStats();
                        break;
                    case 'r':
                        resetPendulums();
                        break;
                    case 'c':
                        clearTrails();
                        break;
                }
            });

            // Resize
            let resizeTimeout;
            window.addEventListener('resize', () => {
                clearTimeout(resizeTimeout);
                resizeTimeout = setTimeout(init, 250);
            });

            // Start
            init();
            requestAnimationFrame(animate);
        </script>
    </body>
</html>
